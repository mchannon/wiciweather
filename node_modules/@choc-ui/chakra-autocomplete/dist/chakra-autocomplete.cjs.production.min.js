"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("react"),n=(e=t)&&"object"==typeof e&&"default"in e?e.default:e,r=require("@chakra-ui/react-utils"),o=require("@chakra-ui/react"),l=require("@chakra-ui/utils"),u=require("react-nanny"),i=require("@chakra-ui/layout"),a=require("@chakra-ui/tag"),s=r.createContext({name:"AutoCompleteContext",errorMessage:"useAutoCompleteContext: `context` is undefined. Seems you forgot to wrap all autoomplete components within `<AutoComplete />`"}),c=s[0],f=s[1];function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e,t){if(null==e)return{};var n,r,o={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(n=l[r])>=0||(o[n]=e[n]);return o}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t,n){function r(e,t){e=" ".repeat(t-1)+e.toLowerCase()+" ".repeat(t-1);for(var n=new Array(e.length-t+1),r=0;r<n.length;r++)n[r]=e.slice(r,r+t);return n}if(void 0===n&&(n=2),null==e||!e.length||null==t||!t.length)return 0;for(var o,l=e.length<t.length?t:e,u=r(e.length<t.length?e:t,n),i=r(l,n),a=new Set(u),s=i.length,c=0,f=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return v(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,void 0):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(i);!(o=f()).done;)a.delete(o.value)&&c++;return c/s}var g=function(e){return("string"==typeof e?e:e[Object.keys(e)[0]]).toString()},h=function(e,t){return"string"!=typeof e||l.isEmpty(t)?e:e.toString().replace(new RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"gi"),(function(e){return"<mark>"+e+"</mark>"}))},y=function(e,t,n){return(null==t?void 0:t.toLowerCase().indexOf(null==e?void 0:e.toLowerCase()))>=0||(null==n?void 0:n.toLowerCase().indexOf(null==e?void 0:e.toLowerCase()))>=0||m(e,t)>=.5||m(e,n)>=.5},b=function(e,t){return d({},t&&d({},e.field,{_focusWithin:e.field._focus,pos:"relative",minH:9,py:1.5,spacing:3}),{cursor:"text",h:"fit-content"})},C=function(e,t){return u.getChildDeep(e,(function(e){var n;return"AutoCompleteItem"===(null==e||null==(n=e.type)?void 0:n.displayName)&&e.props.value===(null==t?void 0:t.value)}))},I=function(e,t){return u.getChildDeep(e,(function(e){var n;return"AutoCompleteItem"===(null==e||null==(n=e.type)?void 0:n.displayName)&&e.props.value===(null==t?void 0:t.value)}))},x=["onBlur","onChange","onFocus","onKeyDown","variant"],O=["_fixed","_focus","children","disabled","label","value","fixed","getValue","onClick","onMouseOver","sx"];function w(e){var n,r,i=e.closeOnBlur,a=void 0===i||i,s=e.closeOnSelect,c=e.creatable,f=e.emphasize,v=e.emptyState,m=void 0===v||v,w=e.freeSolo,S=e.isReadOnly,E=e.listAllValuesOnFocus,F=e.maxSuggestions,A=e.multiple,R=e.defaultValue,j=e.defaultValues,D=void 0===j?R?[R]:[]:j,k=e.onReady,L=e.defaultIsOpen,P=e.restoreOnBlurIfEmpty,N=void 0===P?!w:P,M=e.shouldRenderSuggestions,_=void 0===M?function(){return!0}:M,T=e.submitKeys,V=void 0===T?[]:T,B=e.suggestWhenEmpty,q=e.value,G=e.values,W=void 0===G?q?"string"==typeof q?[q]:[].concat(q):void 0:G;s=s||!A,w=w||!!A||e.freeSolo;var H=o.useDisclosure({defaultIsOpen:L}),U=H.isOpen,z=H.onClose,K=H.onOpen,$=l.runIfFn(e.children,{isOpen:U,onClose:z,onOpen:K}),Y=function(e){return u.getChildrenDeep(e,(function(e){var t;return"AutoCompleteItem"===(null==e||null==(t=e.type)?void 0:t.displayName)})).map((function(e){var t=l.pick(e.props,["value","label","fixed","disabled"]),n=e.props.getValue,r=(void 0===n?g:n)(t.value),o=l.isDefined(t.label)?t:d({},t,{label:r});return d({},o,{value:r,originalValue:t.value})}))}($),Q=t.useRef(null),J=t.useRef(null),X=t.useRef(null),Z=t.useRef(null),ee=t.useState(!1),te=ee[0],ne=ee[1],re="";A?re="":l.isUndefined(D)?l.isUndefined(W)||(re=W[0]):re=D[0];var oe=t.useState(null!=(n=re)?n:""),le=oe[0],ue=oe[1],ie=Y.filter((function(t){return t.fixed||l.runIfFn(e.filter||y,le,t.value,t.label)||te})).filter((function(e,t){return!F||e.fixed||t<F})),ae=[].concat(ie,c?[{value:le,noFilter:!0,creatable:!0}]:[]),se=o.useControllableState({defaultValue:D,value:W,onChange:function(t){var n=ae.find((function(e){return e.value===t[0]})),r=t.map((function(e){return ae.find((function(t){return t.value===e}))}));l.runIfFn(e.onChange,A?t:t[0],A?r:n)}}),ce=se[0],fe=se[1],de=t.useState(null==(r=Y[0])?void 0:r.value),pe=de[0],ve=de[1],me=e.maxSelections||ce.length+1,ge=ae.findIndex((function(e){return e.value===pe})),he=l.getNextItem(ge,ae,!!e.rollNavigation),ye=l.getPrevItem(ge,ae,!!e.rollNavigation),be=l.getFirstItem(ae),Ce=l.getLastItem(ae);o.useUpdateEffect((function(){ve(null==be?void 0:be.value)}),[le]),t.useEffect((function(){var e;U||ve(null==(e=Y[0])?void 0:e.value)}),[U]),t.useEffect((function(){var t=Y.find((function(e){return e.value===pe}));l.runIfFn(e.onOptionFocus,{item:t,focusMethod:Z.current,isNewInput:null==t?void 0:t.creatable})}),[pe,e.onOptionFocus]);var Ie=function(t){var n;!ce.includes(t)&&ce.length<me&&fe((function(e){return A?[].concat(e,[t]):[t]}));var r,o=ae.find((function(e){return e.value===t}));A&&(null==(r=Q.current)||r.focus()),e.focusInputOnSelect&&(null==(n=Q.current)||n.focus()),l.runIfFn(e.onSelectOption,{item:o,selectMethod:Z.current,isNewInput:null==o?void 0:o.creatable}),null!=o&&o.creatable&&l.runIfFn(e.onCreateOption,{item:l.omit(o,["noFilter"]),selectMethod:Z.current});var u=(null==o?void 0:o.label)||(null==o?void 0:o.value);ue((function(){return A?"":null!=u?u:""})),s&&z()},xe=function(t,n){var r;fe((function(n){var r=Y.find((function(e){return e.value===t}));return l.runIfFn(e.onTagRemoved,t,r,n),n.filter((function(e){return e!==t}))})),le===t&&ue(""),n&&(null==(r=Q.current)||r.focus())},Oe=A?ce.map((function(e){var t;return{label:(null==(t=Y.find((function(t){return t.value===e})))?void 0:t.label)||e,onRemove:function(){return xe(e)}}})):[];t.useEffect((function(){l.runIfFn(k,{tags:Oe})}),[ce]);var we=o.useDimensions(J,!0),Se=o.useDimensions(Q,!0);return{autoCompleteProps:e,children:$,filteredList:ae,filteredResults:ie,focusedValue:pe,getEmptyStateProps:function(e){if(ae.every((function(e){return e.noFilter}))&&m&&!c)return"boolean"==typeof m?e:l.runIfFn(m,{query:le})},getGroupProps:function(e){var t=function(e,t){return l.isDefined(u.getChildDeep(e,(function(e){return t.findIndex((function(t){var n;return t.value===(null==(n=e.props)?void 0:n.value)}))>=0})))}(e.children,ae);return{divider:{hasFirstChild:C(e.children,be),hasLastChild:I(e.children,l.getLastItem(ae.filter((function(e){return l.isUndefined(null==e?void 0:e.noFilter)}))))},group:{display:t?"initial":"none"}}},getInputProps:function(t,n){var r=t.onBlur,o=t.onChange,u=t.onFocus,i=t.onKeyDown,s=t.variant,c=p(t,x);return{wrapper:d({ref:J,onClick:function(){var e;null==Q||null==(e=Q.current)||e.focus()}},b(n,A),c),input:d({isReadOnly:S,onFocus:function(t){l.runIfFn(u,t),e.openOnFocus&&!S&&K(),e.selectOnFocus&&t.target.select(),E&&ne(!0)},onBlur:function(e){var t;l.runIfFn(r,e);var n=e.relatedTarget===(null==X?void 0:X.current),o=null==(t=J.current)?void 0:t.contains(e.relatedTarget);if(!n&&!o&&(a&&z(),!ce.includes(e.target.value)&&N)){var u=l.getLastItem(ce),i=Y.find((function(e){return e.value===u}));ue((null==i?void 0:i.label)||(null==i?void 0:i.value)||"")}},onChange:function(e){var t=e.target.value;l.runIfFn(o,e),ue(t);var n=l.isEmpty(t);!l.runIfFn(_,t)||n&&!B?z():K(),ne(!1)},onKeyDown:function(e){l.runIfFn(i,e),Z.current="keyboard";var t,n=e.key,r=ae[ge];return["Enter"].concat(V).includes(n)?(!r||null!=r&&r.disabled?null==(t=Q.current)||t.focus():Ie(null==r?void 0:r.value),void e.preventDefault()):"ArrowDown"===n?(ve(null==he?void 0:he.value),void e.preventDefault()):"ArrowUp"===n?(ve(null==ye?void 0:ye.value),void e.preventDefault()):"Tab"===n?(ve(null==he?void 0:he.value),void(U&&(r.value===(null==Ce?void 0:Ce.value)&&console.log("last"),e.preventDefault()))):"Home"===n?(ve(null==be?void 0:be.value),void e.preventDefault()):"End"===n?(ve(null==Ce?void 0:Ce.value),void e.preventDefault()):void("Escape"===n&&l.callAll(z,e.preventDefault))},value:le,variant:A?"unstyled":s},c)}},getItemProps:function(e,t){var n,r=e._fixed,o=e._focus,u=e.children,i=e.disabled,a=e.label,s=e.value,c=e.fixed,v=e.getValue,m=void 0===v?g:v,y=e.onClick,b=e.onMouseOver,C=e.sx,I=p(e,O),x=t?s:null==(n=m(s))?void 0:n.toString(),w=x===pe,S=ae.findIndex((function(e){return e.value===x}))>=0,E=u||a||x;return{item:d({},"string"==typeof E&&f?{dangerouslySetInnerHTML:{__html:h(E,le)}}:{children:E},{"aria-selected":ce.includes(x),"aria-disabled":i,_disabled:{opacity:.4,cursor:"not-allowed",userSelect:"none"},onClick:function(e){var t;l.runIfFn(y,e),i?null==(t=Q.current)||t.focus():Ie(x)},onMouseOver:function(e){l.runIfFn(b,e),ve(x),Z.current="mouse"},sx:d({},C,{mark:d({color:"inherit",bg:"transparent"},l.isObject(f)?f:{fontWeight:f?"extrabold":"inherit"})})},w&&(o||{bg:"whiteAlpha.100",_light:{bg:"gray.200"}}),c&&r,I),root:{isValidSuggestion:S,value:x}}},getListProps:function(){return{width:e.multiple?null==we?void 0:we.marginBox.width:null==Se?void 0:Se.marginBox.width}},inputRef:Q,interactionRef:Z,isOpen:U,itemList:Y,listRef:X,onClose:z,onOpen:K,query:le,removeItem:xe,resetItems:function(e){var t;fe([]),e&&(null==(t=Q.current)||t.focus())},setQuery:ue,tags:Oe,values:ce}}var S=o.forwardRef((function(e,r){var l=w(e),u=l.children,i=l.isOpen,a=l.onClose,s=l.onOpen,f=l.resetItems,d=l.removeItem;return t.useImperativeHandle(r,(function(){return{resetItems:f,removeItem:d}})),n.createElement(c,{value:l},n.createElement(o.Popover,{isLazy:!0,isOpen:i,onClose:a,onOpen:s,autoFocus:!1,placement:"bottom",closeOnBlur:!0},n.createElement(o.chakra.div,{sx:{".chakra-popover__popper":{position:"unset !important"}},w:"full",ref:r},u)))}));S.displayName="AutoComplete";var E=["children","dangerouslySetInnerHTML"],F=o.forwardRef((function(e,r){var u=f(),i=u.focusedValue,a=u.getItemProps,s=u.interactionRef,c=t.useRef(),d=o.useMergeRefs(r,c),v=a(e),m=v.root,g=m.isValidSuggestion,h=m.value,y=i===h;t.useEffect((function(){var e;y&&"keyboard"===s.current&&(null==c||null==(e=c.current)||e.scrollIntoView({behavior:"smooth",block:"center"}))}),[y,s]),t.useEffect((function(){"string"!=typeof h&&console.warn("wow"),"string"!=typeof h&&l.isUndefined(e.getValue)&&console.error("You must define the `getValue` prop, when an Item's value is not a string")}),[]);var b=v.item,C=b.children,I=b.dangerouslySetInnerHTML,x=p(b,E),O=l.omit(x,["groupId"]);return g?n.createElement(o.Flex,Object.assign({ref:d},A,O),C||n.createElement("span",{dangerouslySetInnerHTML:I})):null}));F.displayName="AutoCompleteItem";var A={mx:"2",px:"2",py:"2",rounded:"md",cursor:"pointer"},R=["children"],j=["children"];function D(e){var t=e.children,r=p(e,R),u=f(),i=u.autoCompleteProps,a=u.getItemProps,s=u.query,c=u.filteredResults,v=n.createElement("mark",null,s),m=a(d({},e,{value:s,children:l.runIfFn(t,{value:v})}),!0).item,g=m.children,h=p(m,j),y=c.some((function(e){return e.value===s}));return!i.creatable||l.isEmpty(s)||y?null:n.createElement(o.Flex,Object.assign({},A,h,r),g||"Add "+s)}D.displayName="AutoCompleteCreatable";var k=["children","showDivider"],L=o.forwardRef((function(e,t){var r=e.children,u=p(e,k),i=l.omit(u,["groupSibling"]),a=(0,f().getGroupProps)(e).group,s=M(e);return n.createElement(o.Box,Object.assign({ref:t},a,i),n.createElement(o.Divider,Object.assign({},s.top)),r,n.createElement(o.Divider,Object.assign({},s.bottom)))})),P=o.forwardRef((function(e,t){return n.createElement(o.Flex,Object.assign({},N,e,{ref:t}))}));L.displayName="AutoCompleteGroup",P.displayName="AutoCompleteGroupTitle";var N={ml:5,my:1,fontSize:"xs",letterSpacing:"wider",fontWeight:"extrabold",textTransform:"uppercase"},M=function(e){var t=f(),n=e.groupSibling,r=(0,t.getGroupProps)(e).divider,o=r.hasLastChild,l={my:2,borderColor:e.dividerColor};return{top:d({},l,{mb:4,display:!e.showDivider||r.hasFirstChild?"none":""}),bottom:d({},l,{display:!e.showDivider||o||n?"none":""})}},_=["children"],T=["ref"],V=o.forwardRef((function(e,t){var r=f(),u=r.autoCompleteProps,i=r.inputRef,a=r.tags,s=e.children,c=(0,r.getInputProps)(p(e,_),o.useMultiStyleConfig("Input",e)),d=c.wrapper,v=c.input,m=d.ref,g=p(d,T),h=o.useMergeRefs(t,i),y=l.runIfFn(s,{tags:a}),b=n.createElement(o.Input,Object.assign({},v,{ref:h})),C=n.createElement(o.Wrap,Object.assign({},g,{ref:m}),y,n.createElement(o.WrapItem,Object.assign({as:o.Input},v,{ref:h})));return n.createElement(n.Fragment,null,u.multiple?C:b)}));V.displayName="Input",V.id="Input";var B=function(e){var t=(0,f().getEmptyStateProps)(n.createElement(i.Flex,Object.assign({},q),"No options found!"));return n.createElement(i.Box,Object.assign({},e),t)},q={fontSize:"sm",align:"center",justify:"center",fontWeight:"bold",fontStyle:"italic"},G=["children"],W=o.forwardRef((function(e,t){var r=e.children,l=p(e,G),u=f(),i=u.getListProps,a=o.useMergeRefs(t,u.listRef),s=i();return n.createElement(o.PopoverContent,Object.assign({ref:a},H,s,l),function(e){return n.Children.map(e,(function(t,r){if("AutoCompleteGroup"===t.type.displayName){var o=n.Children.toArray(e)[r+1];return n.cloneElement(t,{groupSibling:!!o&&"AutoCompleteGroup"===o.type.displayName})}return t}))}(r),n.createElement(B,null))}));W.displayName="AutoCompleteList";var H={mt:"4",py:"4",opacity:"0",bg:"#232934",rounded:"md",maxH:"350px",border:"none",shadow:"base",pos:"absolute",zIndex:"popover",overflowY:"auto",_light:{bg:"#ffffff"},_focus:{boxShadow:"none"}},U=["label","onRemove","disabled"],z=t.memo((function(e){var t=e.label,r=e.onRemove,o=e.disabled,u=p(e,U);return n.createElement(i.WrapItem,null,n.createElement(a.Tag,Object.assign({borderRadius:"md",fontWeight:"normal"},o&&K,u),n.createElement(a.TagLabel,null,t),n.createElement(a.TagCloseButton,Object.assign({onClick:function(){return!o&&l.runIfFn(r)},cursor:"pointer"},o&&K))))})),K={cursor:"text",userSelect:"none",opacity:.4,_focus:{boxShadow:"none"}};exports.AutoComplete=S,exports.AutoCompleteCreatable=D,exports.AutoCompleteGroup=L,exports.AutoCompleteGroupTitle=P,exports.AutoCompleteInput=V,exports.AutoCompleteItem=F,exports.AutoCompleteList=W,exports.AutoCompleteProvider=c,exports.AutoCompleteTag=z,exports.baseItemStyles=A,exports.useAutoComplete=w,exports.useAutoCompleteContext=f;
//# sourceMappingURL=chakra-autocomplete.cjs.production.min.js.map
